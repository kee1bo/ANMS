<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter & Sort Interface Test - Pet Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/app.css">
    <link rel="stylesheet" href="assets/css/filter-sort-interface.css">
    <style>
        body {
            background: #f3f4f6;
            padding: 20px;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-header {
            background: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .test-results {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .results-count {
            color: #6b7280;
            font-size: 14px;
        }
        
        .pet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .pet-card {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background: white;
            transition: all 0.2s ease;
        }
        
        .pet-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .pet-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .pet-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #6b7280;
        }
        
        .pet-info h3 {
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
        }
        
        .pet-species {
            font-size: 14px;
            color: #6b7280;
        }
        
        .pet-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 13px;
        }
        
        .pet-detail {
            display: flex;
            justify-content: space-between;
        }
        
        .pet-detail-label {
            color: #6b7280;
        }
        
        .pet-detail-value {
            color: #374151;
            font-weight: 500;
        }
        
        .health-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .health-status.healthy {
            background: #dcfce7;
            color: #166534;
        }
        
        .health-status.needs-attention {
            background: #fef3c7;
            color: #92400e;
        }
        
        .health-status.chronic-condition {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .activity-level {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .activity-level.low {
            background: #f3f4f6;
            color: #374151;
        }
        
        .activity-level.medium {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .activity-level.high {
            background: #dcfce7;
            color: #166534;
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }
        
        .no-results i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .debug-panel {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            margin-top: 24px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .debug-title {
            color: #60a5fa;
            font-weight: bold;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class=\"test-container\">
        <div class=\"test-header\">
            <h1><i class=\"fas fa-filter\"></i> Filter & Sort Interface Test</h1>
            <p>Test the advanced filtering and sorting functionality for pet management.</p>
        </div>
        
        <!-- Filter and Sort Interface -->
        <div id=\"filter-sort-container\"></div>
        
        <!-- Results Display -->
        <div class=\"test-results\">
            <div class=\"results-header\">
                <h2>Pet Results</h2>
                <div class=\"results-count\" id=\"results-count\">Loading...</div>
            </div>
            
            <div class=\"pet-grid\" id=\"pet-results\">
                <!-- Results will be populated here -->
            </div>
            
            <div class=\"no-results\" id=\"no-results\" style=\"display: none;\">
                <i class=\"fas fa-search\"></i>
                <h3>No pets found</h3>
                <p>Try adjusting your filters or search criteria.</p>
            </div>
        </div>
        
        <!-- Debug Panel -->
        <div class=\"debug-panel\">
            <div class=\"debug-title\">Debug Information</div>
            <div id=\"debug-info\">Initializing...</div>
        </div>
    </div>

    <script src=\"assets/js/components/filter-sort-interface.js\"></script>
    <script>
        // Mock pet data for testing
        const mockPets = [
            {
                id: 1,
                name: \"Buddy\",
                species: \"dog\",
                breed: \"Golden Retriever\",
                age: 3.5,
                weight: 28.5,
                activity_level: \"high\",
                health_status: \"healthy\",
                spay_neuter_status: \"neutered\",
                has_photos: true,
                has_health_conditions: false,
                created_at: \"2023-01-15\",
                updated_at: \"2024-01-10\"
            },
            {
                id: 2,
                name: \"Whiskers\",
                species: \"cat\",
                breed: \"Persian\",
                age: 2.0,
                weight: 4.2,
                activity_level: \"low\",
                health_status: \"healthy\",
                spay_neuter_status: \"spayed\",
                has_photos: true,
                has_health_conditions: false,
                created_at: \"2023-03-20\",
                updated_at: \"2024-01-08\"
            },
            {
                id: 3,
                name: \"Charlie\",
                species: \"dog\",
                breed: \"Labrador Retriever\",
                age: 7.2,
                weight: 32.1,
                activity_level: \"medium\",
                health_status: \"chronic_condition\",
                spay_neuter_status: \"neutered\",
                has_photos: false,
                has_health_conditions: true,
                created_at: \"2022-08-10\",
                updated_at: \"2024-01-12\"
            },
            {
                id: 4,
                name: \"Luna\",
                species: \"cat\",
                breed: \"Maine Coon\",
                age: 1.5,
                weight: 5.8,
                activity_level: \"high\",
                health_status: \"healthy\",
                spay_neuter_status: \"spayed\",
                has_photos: true,
                has_health_conditions: false,
                created_at: \"2023-06-05\",
                updated_at: \"2024-01-09\"
            },
            {
                id: 5,
                name: \"Max\",
                species: \"dog\",
                breed: \"German Shepherd\",
                age: 5.0,
                weight: 35.7,
                activity_level: \"high\",
                health_status: \"needs_attention\",
                spay_neuter_status: \"intact\",
                has_photos: true,
                has_health_conditions: true,
                created_at: \"2022-12-01\",
                updated_at: \"2024-01-11\"
            },
            {
                id: 6,
                name: \"Bella\",
                species: \"dog\",
                breed: \"Bulldog\",
                age: 4.3,
                weight: 22.8,
                activity_level: \"low\",
                health_status: \"healthy\",
                spay_neuter_status: \"spayed\",
                has_photos: false,
                has_health_conditions: false,
                created_at: \"2023-02-14\",
                updated_at: \"2024-01-07\"
            },
            {
                id: 7,
                name: \"Tweety\",
                species: \"bird\",
                breed: \"Canary\",
                age: 0.8,
                weight: 0.02,
                activity_level: \"medium\",
                health_status: \"healthy\",
                spay_neuter_status: \"unknown\",
                has_photos: true,
                has_health_conditions: false,
                created_at: \"2023-09-12\",
                updated_at: \"2024-01-06\"
            },
            {
                id: 8,
                name: \"Fluffy\",
                species: \"rabbit\",
                breed: \"Holland Lop\",
                age: 2.5,
                weight: 1.8,
                activity_level: \"medium\",
                health_status: \"healthy\",
                spay_neuter_status: \"spayed\",
                has_photos: true,
                has_health_conditions: false,
                created_at: \"2023-04-18\",
                updated_at: \"2024-01-05\"
            }
        ];

        let filteredPets = [...mockPets];
        let filterSort;

        // Initialize the filter sort interface
        document.addEventListener('DOMContentLoaded', function() {
            filterSort = new FilterSortInterface('filter-sort-container', {
                onFiltersChange: handleFiltersChange,
                onSortChange: handleSortChange,
                onReset: handleReset
            });

            // Initial display
            displayPets(filteredPets);
            updateDebugInfo();
        });

        function handleFiltersChange(filters) {
            console.log('Filters changed:', filters);
            applyFiltersAndSort();
            updateDebugInfo();
        }

        function handleSortChange(sortOptions) {
            console.log('Sort changed:', sortOptions);
            applyFiltersAndSort();
            updateDebugInfo();
        }

        function handleReset() {
            console.log('Filters and sort reset');
            filteredPets = [...mockPets];
            displayPets(filteredPets);
            updateDebugInfo();
        }

        function applyFiltersAndSort() {
            const state = filterSort.getState();
            const { filters, sort } = state;

            // Apply filters
            filteredPets = mockPets.filter(pet => {
                // Species filter
                if (filters.species && pet.species !== filters.species) {
                    return false;
                }

                // Breed filter
                if (filters.breed && !pet.breed.toLowerCase().includes(filters.breed.toLowerCase())) {
                    return false;
                }

                // Age range filter
                if (filters.age_min && pet.age < parseFloat(filters.age_min)) {
                    return false;
                }
                if (filters.age_max && pet.age > parseFloat(filters.age_max)) {
                    return false;
                }

                // Weight range filter
                if (filters.weight_min && pet.weight < parseFloat(filters.weight_min)) {
                    return false;
                }
                if (filters.weight_max && pet.weight > parseFloat(filters.weight_max)) {
                    return false;
                }

                // Activity level filter
                if (filters.activity_level && pet.activity_level !== filters.activity_level) {
                    return false;
                }

                // Health status filter
                if (filters.health_status && pet.health_status !== filters.health_status) {
                    return false;
                }

                // Spay/neuter status filter
                if (filters.spay_neuter_status && pet.spay_neuter_status !== filters.spay_neuter_status) {
                    return false;
                }

                // Has photos filter
                if (filters.has_photos && !pet.has_photos) {
                    return false;
                }

                // Has health conditions filter
                if (filters.has_health_conditions && !pet.has_health_conditions) {
                    return false;
                }

                return true;
            });

            // Apply sorting
            filteredPets.sort((a, b) => {
                let aValue = a[sort.field];
                let bValue = b[sort.field];

                // Handle different data types
                if (typeof aValue === 'string') {
                    aValue = aValue.toLowerCase();
                    bValue = bValue.toLowerCase();
                }

                if (aValue < bValue) {
                    return sort.order === 'asc' ? -1 : 1;
                }
                if (aValue > bValue) {
                    return sort.order === 'asc' ? 1 : -1;
                }
                return 0;
            });

            displayPets(filteredPets);
        }

        function displayPets(pets) {
            const resultsContainer = document.getElementById('pet-results');
            const noResults = document.getElementById('no-results');
            const resultsCount = document.getElementById('results-count');

            resultsCount.textContent = `${pets.length} pet${pets.length !== 1 ? 's' : ''} found`;

            if (pets.length === 0) {
                resultsContainer.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }

            resultsContainer.style.display = 'grid';
            noResults.style.display = 'none';

            resultsContainer.innerHTML = pets.map(pet => `
                <div class=\"pet-card\">
                    <div class=\"pet-header\">
                        <div class=\"pet-avatar\">
                            <i class=\"fas ${getPetIcon(pet.species)}\"></i>
                        </div>
                        <div class=\"pet-info\">
                            <h3>${pet.name}</h3>
                            <div class=\"pet-species\">${pet.breed} ${pet.species}</div>
                        </div>
                    </div>
                    <div class=\"pet-details\">
                        <div class=\"pet-detail\">
                            <span class=\"pet-detail-label\">Age:</span>
                            <span class=\"pet-detail-value\">${pet.age} years</span>
                        </div>
                        <div class=\"pet-detail\">
                            <span class=\"pet-detail-label\">Weight:</span>
                            <span class=\"pet-detail-value\">${pet.weight}kg</span>
                        </div>
                        <div class=\"pet-detail\">
                            <span class=\"pet-detail-label\">Activity:</span>
                            <span class=\"pet-detail-value\">
                                <span class=\"activity-level ${pet.activity_level}\">${pet.activity_level}</span>
                            </span>
                        </div>
                        <div class=\"pet-detail\">
                            <span class=\"pet-detail-label\">Health:</span>
                            <span class=\"pet-detail-value\">
                                <span class=\"health-status ${pet.health_status.replace('_', '-')}\">${formatHealthStatus(pet.health_status)}</span>
                            </span>
                        </div>
                        <div class=\"pet-detail\">
                            <span class=\"pet-detail-label\">Photos:</span>
                            <span class=\"pet-detail-value\">${pet.has_photos ? 'Yes' : 'No'}</span>
                        </div>
                        <div class=\"pet-detail\">
                            <span class=\"pet-detail-label\">Conditions:</span>
                            <span class=\"pet-detail-value\">${pet.has_health_conditions ? 'Yes' : 'No'}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getPetIcon(species) {
            const icons = {
                dog: 'fa-dog',
                cat: 'fa-cat',
                bird: 'fa-dove',
                rabbit: 'fa-rabbit',
                other: 'fa-paw'
            };
            return icons[species] || icons.other;
        }

        function formatHealthStatus(status) {
            return status.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());
        }

        function updateDebugInfo() {
            const debugInfo = document.getElementById('debug-info');
            const state = filterSort ? filterSort.getState() : { filters: {}, sort: {}, activeFiltersCount: 0 };
            
            debugInfo.innerHTML = `
                <strong>Active Filters:</strong> ${state.activeFiltersCount}<br>
                <strong>Filtered Results:</strong> ${filteredPets.length} / ${mockPets.length}<br>
                <strong>Sort Field:</strong> ${state.sort.field || 'none'}<br>
                <strong>Sort Order:</strong> ${state.sort.order || 'none'}<br>
                <strong>Current Filters:</strong><br>
                ${Object.entries(state.filters)
                    .filter(([key, value]) => value !== '' && value !== false)
                    .map(([key, value]) => `&nbsp;&nbsp;${key}: ${value}`)
                    .join('<br>') || '&nbsp;&nbsp;None'}
            `;
        }

        // Make filterSort available globally for testing
        window.filterSort = filterSort;
    </script>
</body>
</html>"